Sample code to reproduce Figure 3.8.

The reference code link:  