Sample code to reproduce Figure 2.12.

The reference code link:  